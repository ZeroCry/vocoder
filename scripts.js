var VOC=VOC||{};VOC.consts={DEBUG:!0,URL:"https://monocasual.github.com/vocoder/",TITLE:"Vocoder - Probably one of the best text-to-speech online apps in the world (if your browser supports it).",FACEBOOK:{APP_ID:"944978492290626",API_URL:"https://connect.facebook.net/en_US/sdk.js",API_VERSION:"v2.6",GRAPH_URL:"https://graph.facebook.com/"},TWITTER:{SHARE_URL:"https://twitter.com/share"}},(VOC=VOC||{}).TwitterAPI={openShareDialog:function(e,s){var t=VOC.consts.TWITTER.SHARE_URL+"?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(s);VOC.utils.openPopup(t,575,400,"twitter_popup")}},(VOC=VOC||{}).Shares={elems:{shares:$(".voc-base__social-shares"),facebook:$(".voc-base__social-shares__facebook"),twitter:$(".voc-base__social-shares__twitter"),facebook_count:$(".voc-base__social-shares__facebook__count"),twitter_count:$(".voc-base__social-shares__twitter__count")},init:function(){this.elems.shares.show(),this.elems.facebook.click(function(e){VOC.utils.sendAnalytics("Action","Share on Facebook"),VOC.FacebookAPI.openShareDialog(VOC.consts.URL)}),this.elems.twitter.click(function(e){VOC.utils.sendAnalytics("Action","Share on Twitter"),VOC.TwitterAPI.openShareDialog(VOC.consts.URL,VOC.consts.TITLE)})}},$(document).ready(function(){VOC.FacebookAPI.init(function(){VOC.Shares.init()})}),(VOC=VOC||{}).Base={elems:{base:$(".voc-base"),shares:$(".voc-base__social-shares"),noSpeech:$(".voc-base__alerts__no-speech"),noVoices:$(".voc-base__alerts__no-voices"),form:$(".voc-base__form"),textarea:$(".voc-base__form__textarea"),status:$(".voc-base__form__status"),voices:$('select[name="voices"]'),speak:$('button[name="speak"]'),pause:$('button[name="pause"]'),cancel:$('button[name="cancel"]'),volume:$('input[name="volume"]'),pitch:$('input[name="pitch"]'),rate:$('input[name="rate"]')},vars:{synth:window.speechSynthesis,utter:new SpeechSynthesisUtterance,voices:Array()},hasVoices:function(){return this.vars.synth.getVoices().length>0},loadVoices:function(e){var s=this,t=0,n=setInterval(function(){s.vars.voices=s.vars.synth.getVoices(),(s.vars.voices.length>0||t>=10)&&(clearInterval(n),e()),t++,VOC.utils.debug("Load voices, try "+t)},50)},populateVoicesMenu:function(){for(var e=0;e<this.vars.voices.length;e++)this.elems.voices.append($("<option>",{value:e,text:this.vars.voices[e].voiceURI}))},speak:function(){VOC.utils.sendAnalytics("Action","Speak"),this.vars.synth.pending||this.vars.synth.speaking?(VOC.utils.debug("Pending voices, killing the queue"),this.vars.synth.cancel()):VOC.utils.debug("No pending voices"),this.vars.utter.voice=this.vars.voices[this.elems.voices.val()],this.vars.utter.volume=this.elems.volume.val(),this.vars.utter.pitch=this.elems.pitch.val(),this.vars.utter.rate=this.elems.rate.val(),this.vars.utter.text=this.elems.textarea.val(),this.vars.synth.speak(this.vars.utter)},pause:function(){VOC.utils.sendAnalytics("Action","Pause"),this.vars.synth.paused?this.vars.synth.resume():this.vars.synth.pause()},cancel:function(){VOC.utils.sendAnalytics("Action","Cancel"),this.vars.synth.cancel()},init:function(){var e=this;return Modernizr.speechsynthesis?this.hasVoices()?(this.populateVoicesMenu(),this.elems.form.show(),this.elems.speak.click(function(s){e.speak()}),this.elems.pause.click(function(s){e.pause()}),this.elems.cancel.click(function(s){e.cancel()}),this.vars.utter.onerror=function(s){e.elems.status.html("Error: "+s.error),VOC.utils.debug("Speech synthesis error: "+s.error)},this.vars.utter.onstart=function(s){e.elems.status.html("Speaking..."),e.elems.speak.prop("disabled",!0),e.elems.pause.prop("disabled",!1),e.elems.cancel.prop("disabled",!1),VOC.utils.debug("Speech synthesis started")},this.vars.utter.onpause=function(s){e.elems.status.html("Paused"),VOC.utils.debug("Speech synthesis paused")},void(this.vars.utter.onend=function(s){e.elems.status.html("&nbsp;"),e.elems.speak.prop("disabled",!1),e.elems.pause.prop("disabled",!0),e.elems.cancel.prop("disabled",!0),VOC.utils.debug("Speech synthesis ended")})):(this.elems.noVoices.show(),VOC.utils.debug("No voices found"),void VOC.utils.sendAnalytics("API status","API OK, no voices found")):(this.elems.noSpeech.show(),VOC.utils.debug("No speech synthesis API available"),void VOC.utils.sendAnalytics("API status","No speech synthesis API available"))}},$(document).ready(function(){VOC.Base.loadVoices(function(){VOC.Base.init()})}),(VOC=VOC||{}).utils={debug:function(e){},sendAnalytics:function(e,s){gtag("event",e,{action:s})},openPopup:function(e,s,t,n){var o=",width="+s+",height="+t+",top="+($(window).height()-t)/2+",left="+($(window).width()-s)/2,i=window.open(e,n,o);window.focus&&i.focus()}},(VOC=VOC||{}).FacebookAPI={init:function(e){$.getScript(VOC.consts.FACEBOOK.API_URL).done(function(s,t){FB.init({appId:VOC.consts.FACEBOOK.APP_ID,xfbml:!0,version:VOC.consts.FACEBOOK.API_VERSION}),e&&e()}).fail(function(e,s,t){VOC.utils.debug("Can't load Facebook API remote script")})},openShareDialog:function(e,s,t){FB.ui({method:"share",href:e},function(e){e&&!e.error_message&&(s?s(e):(VOC.utils.log("Cannot open share dialog, wrong response:"),VOC.utils.log(e),t&&t(e.error_message)))})},countShares:function(e,s){var t=VOC.consts.FACEBOOK.GRAPH_URL+"?id="+e;$.getJSON(t).done(function(e){e.hasOwnProperty("share")?e.share.hasOwnProperty("share_count")?s(e.share.share_count):(VOC.utils.log('Wrong response, missing "share_count" key:'),VOC.utils.log(e),s(-1)):(VOC.utils.log('Wrong response, missing "share" key:'),VOC.utils.log(e),s(-1))}).fail(function(e){VOC.utils.log("Count shares error. Response:"),VOC.utils.log(e)})}},function(e,s,t){function n(e,s){return typeof e===s}var o=[],i=[],a={_version:"3.5.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,s){var t=this;setTimeout(function(){s(t[e])},0)},addTest:function(e,s,t){i.push({name:e,fn:s,options:t})},addAsyncTest:function(e){i.push({name:null,fn:e})}},c=function(){};c.prototype=a,(c=new c).addTest("speechsynthesis","SpeechSynthesisUtterance"in e);var r=s.documentElement,l="svg"===r.nodeName.toLowerCase();(function(){var e,s,t,a,r,l,u;for(var h in i)if(i.hasOwnProperty(h)){if(e=[],(s=i[h]).name&&(e.push(s.name.toLowerCase()),s.options&&s.options.aliases&&s.options.aliases.length))for(t=0;t<s.options.aliases.length;t++)e.push(s.options.aliases[t].toLowerCase());for(a=n(s.fn,"function")?s.fn():s.fn,r=0;r<e.length;r++)l=e[r],1===(u=l.split(".")).length?c[u[0]]=a:(!c[u[0]]||c[u[0]]instanceof Boolean||(c[u[0]]=new Boolean(c[u[0]])),c[u[0]][u[1]]=a),o.push((a?"":"no-")+u.join("-"))}})(),function(e){var s=r.className,t=c._config.classPrefix||"";if(l&&(s=s.baseVal),c._config.enableJSClass){var n=new RegExp("(^|\\s)"+t+"no-js(\\s|$)");s=s.replace(n,"$1"+t+"js$2")}c._config.enableClasses&&(s+=" "+t+e.join(" "+t),l?r.className.baseVal=s:r.className=s)}(o),delete a.addTest,delete a.addAsyncTest;for(var u=0;u<c._q.length;u++)c._q[u]();e.Modernizr=c}(window,document);